# === DataSource (Reactive Pg) ===
quarkus.datasource.db-kind=postgresql
quarkus.datasource.reactive.url=postgresql://${DB_URL:localhost:5432}/${DB_NAME:postgres}?search_path=${DB_SCHEMA:public}&options=-c%20synchronous_commit%3D${SYNCHRONOUS_COMMIT:off}%20-c%20work_mem%3D${WORK_MEM:64MB}
quarkus.datasource.username=${DB_USERNAME:postgres}
quarkus.datasource.password=${DB_PASSWORD:password}
quarkus.datasource.reactive.idle-timeout=${REACTIVE_IDLE_TIMEOUT:PT5M}
quarkus.datasource.reactive.max-size=${REACTIVE_MAX_SIZE:600}
quarkus.datasource.reactive.event-loop-size=${REACTIVE_EVENT_LOOP_SIZE:22}
quarkus.datasource.reactive.additional-properties."application_name"=${REACTIVE_APPLICATION_NAME:migrator}
quarkus.datasource.metrics.enabled=${DATASOURCE_METRICS_ENABLED:true}

# === Outbox Requeue Buffer (disk) ===
app.outbox.dir=${APP_OUTBOX_DIR:data/outbox}
app.outbox.segment-max-bytes=${APP_OUTBOX_SEGMENT_MAX_BYTES:67108864}
app.outbox.drain-interval-ms=${APP_OUTBOX_DRAIN_INTERVAL:5000}
app.outbox.drain-batch-size=${APP_OUTBOX_DRAIN_BATCH_SIZE:500}
app.outbox.db-concurrency=${APP_OUTBOX_DB_CONCURRENCY:16}

# === Processing tuning ===
app.fetch-size=${APP_FETCH_SIZE:2000}
app.concurrency=${APP_CONCURRENCY:64}
app.idle-ms=${APP_IDLE_MS:100}
app.max-attempts=${APP_MAX_ATTEMPTS:1000}
app.claimers=${APP_CLAIMERS:32}

# === REST endpoints (demo targets) ===
quarkus.rest-client.http2=${QUARKUS_REST_CLIENT_HTTP2:true}
quarkus.rest-client.connection-ttl=${QUARKUS_REST_CONNECTION_TTL:60000}
quarkus.rest-client.connect-timeout=${QUARKUS_REST_CLIENT_CONNECT_TIMEOUT:5000}
quarkus.rest-client.read-timeout=${QUARKUS_REST_CLIENT_READ_TIMEOUT:10000}

quarkus.rest-client."order-api".url=${ORDER_API_URL:http://localhost:8081}
quarkus.rest-client."order-api".connection-pool-size=${REST_CLIENT_CONNECTION_POOL_SIZE:64}

quarkus.rest-client."invoice-api".url=${INVOICE_API_URL:http://localhost:8081}
quarkus.rest-client."invoice-api".connection-pool-size=${REST_CLIENT_CONNECTION_POOL_SIZE:64}

# vert.x settings:
quarkus.vertx.prefer-native-transport=${VERTX_NATIVE-TRANSPORT:true}
quarkus.vertx.event-loops-pool-size=${VERTX_EVENT_LOOP_SIZE:22}
quarkus.vertx.use-async-dns=${VERTX_ASYNC_DNS:true}

# HTTP/TCP settings:
quarkus.http.http2=${QUARKUS_HTTP_HTTP2:true}
quarkus.http.io-threads=${QUARKUS_HTTP_IO_THREADS:22}
quarkus.http.so-reuse-port=${QUARKUS_HTTP_REUSE_PORT:true}
quarkus.http.tcp-fast-open=${QUARKUS_HTTP_TCP_FAST_OPEN:true}
quarkus.http.tcp-quick-ack=${QUARKUS_HTTP_TCP_QUICK_ACK:true}
quarkus.http.tcp-cork=${QUARKUS_HTTP_TCP_CORK:false}

# Micrometer
# http://localhost:9000/q/metrics
quarkus.management.enabled=${QUARKUS_MANAGEMENT_ENABLED:true}
quarkus.management.port=${QUARKUS_MANAGEMENT_PORT:9000}
quarkus.micrometer.binder.http-client.enabled=${QUARKUS_MICROMETER_BINDER_HTTP_CLIENT_ENABLED:true}
quarkus.micrometer.export.prometheus.enabled=${QUARKUS_MICROMETER_EXPORT_PROMETHEUS_ENABLED:true}
quarkus.micrometer.binder.vertx.enabled=${QUARKUS_MICROMETER_BINDER_VERTX_ENABLED:true}
quarkus.micrometer.binder.mp-metrics.enabled=${QUARKUS_MICROMETER_BINDER_MP_METRICS_ENABLED:true}
quarkus.micrometer.binder.jvm=${QUARKUS_MICROMETER_BINDER_JVM:true}
quarkus.micrometer.binder.system=${QUARKUS_MICROMETER_BINDER_SYSTEM:true}